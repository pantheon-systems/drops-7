This is a fork of http://drupal.org/node/1480204

Will try to merge efforts.
